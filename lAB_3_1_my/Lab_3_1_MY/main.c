#include <stdio.h>
#include <math.h>    // бібліотека для математичних функцій (pow, sin, cos тощо)

// ---- функція f(x) ----
// Ця функція обчислює значення функції f_test(x) = x³ - 2x + 1
double f_test(double x) {
    return pow(x, 3) - 2 * x + 1; // повертає x^3 - 2*x + 1
}

// ---- похідна функції f'(x) ----
// Ця функція обчислює значення похідної f_derivative(x) = 3x² - 2
double f_derivative(double x) {
    return 3 * pow(x, 2) - 2; // повертає 3*x^2 - 2
}

int main() {
    double x1, x2, delta;  // змінні для початкової та кінцевої точки проміжку і кроку
    int n, choice;          // n — кількість точок, choice — вибір способу введення

    // ---- вибір способу введення даних ----
    printf("1 - enter data by number of points (N)\n"); // варіант введення за кількістю точок
    printf("2 - enter data by step size (delta)\n");    // варіант введення за кроком
    printf("Your choice: ");                             // запит вибору
    scanf("%d", &choice);                                // зчитування вибору

    // ---- введення меж проміжку ----
    printf("Enter X1: "); // запит початкового значення проміжку
    scanf("%lf", &x1);    // зчитування x1
    printf("Enter X2: "); // запит кінцевого значення проміжку
    scanf("%lf", &x2);    // зчитування x2

    // ---- обчислення кроку або кількості точок ----
    if (choice == 1) {
        // якщо користувач обрав варіант за кількістю точок
        printf("Enter number of points N (>1): ");
        scanf("%d", &n);               // зчитування кількості точок
        delta = (x2 - x1) / (n - 1);   // обчислення кроку між точками
    } else {
        // якщо користувач обрав варіант за кроком delta
        printf("Enter step delta: ");
        scanf("%lf", &delta);           // зчитування кроку
        n = (int)((x2 - x1) / delta) + 1; // обчислення кількості точок за кроком
    }

    // ---- вивід параметрів розрахунку ----
    printf("\nX1 = %.3lf, X2 = %.3lf, delta = %.3lf, N = %d\n", x1, x2, delta, n);
    printf("---------------------------------------------------------------\n");
    printf("|   i   |    x    |     f(x)     |    f'(x)     |\n"); // заголовки таблиці
    printf("---------------------------------------------------------------\n");

    // ---- основний цикл для обчислення і виводу значень функції та похідної ----
    double x = x1;                   // початкове значення x
    for (int i = 0; i < n; i++) {
        // вивід номера точки, значення x, функції f(x) та похідної f'(x)
        printf("| %5d | %7.3lf | %12.6lf | %12.6lf |\n", i + 1, x, f_test(x), f_derivative(x));
        x += delta; // збільшуємо x на крок delta
    }

    // ---- кінець таблиці ----
    printf("---------------------------------------------------------------\n");

    return 0; // завершення програми з кодом успішного виконання
}
